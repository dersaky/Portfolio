<template>
  <div class="min-h-screen relative">
    <!-- Global Particle Background -->
    <ParticleBackground />
    <!-- Global overlay to unify background tone across sections (below particles, below content) -->
    <div class="fixed inset-0 z-0 pointer-events-none bg-accent-100/60 dark:bg-dark-900/70"></div>
    <!-- Navigation -->
    <nav class="fixed top-0 left-0 right-0 z-50 backdrop-blur-sm border-b bg-white/80 border-accent-200 dark:bg-dark-900/90 dark:border-dark-800">
      <div class="container-max px-6 py-4">
        <div class="flex justify-between items-center">
          <div class="text-xl font-bold text-gray-900 dark:text-primary-400">Dmytro</div>
          <div class="hidden md:flex items-center space-x-6">
            <a href="#home" class="text-gray-700 hover:text-accent-600 transition-colors duration-300 dark:text-gray-300 dark:hover:text-primary-400">{{ t('nav.home') }}</a>
            <a href="#skills" class="text-gray-700 hover:text-accent-600 transition-colors duration-300 dark:text-gray-300 dark:hover:text-primary-400">{{ t('nav.skills') }}</a>
            <a href="#projects" class="text-gray-700 hover:text-accent-600 transition-colors duration-300 dark:text-gray-300 dark:hover:text-primary-400">{{ t('nav.projects') }}</a>
            <a href="#contact" class="text-gray-700 hover:text-accent-600 transition-colors duration-300 dark:text-gray-300 dark:hover:text-primary-400">{{ t('nav.contact') }}</a>
            <!-- Language Switcher -->
            <div class="flex items-center space-x-2 ml-2">
              <button @click="setLocale('uk')"
                      :class="['px-3 py-1 rounded-md text-sm border transition-colors', locale === 'uk' ? 'bg-accent-500/20 text-accent-700 border-accent-500 dark:bg-primary-600/30 dark:text-primary-200 dark:border-primary-600' : 'bg-white text-gray-700 border-accent-300 hover:border-accent-500 dark:bg-dark-800 dark:text-gray-300 dark:border-dark-700 dark:hover:border-primary-600/60']">
                UA
              </button>
              <button @click="setLocale('en')"
                      :class="['px-3 py-1 rounded-md text-sm border transition-colors', locale === 'en' ? 'bg-accent-500/20 text-accent-700 border-accent-500 dark:bg-primary-600/30 dark:text-primary-200 dark:border-primary-600' : 'bg-white text-gray-700 border-accent-300 hover:border-accent-500 dark:bg-dark-800 dark:text-gray-300 dark:border-dark-700 dark:hover:border-primary-600/60']">
                EN
              </button>
              <!-- Theme Toggle: pill switch (refined) -->
              <button @click="toggleTheme" :aria-pressed="theme === 'dark'" class="ml-2 relative inline-flex items-center rounded-full transition-colors duration-300 select-none w-32 h-10 border bg-accent-100/80 border-accent-200 text-accent-700 dark:bg-dark-800 dark:border-dark-700 dark:text-gray-200">
                <!-- Labels -->
                <span class="absolute left-4 text-sm font-semibold pointer-events-none select-none" :class="theme === 'dark' ? 'text-gray-400' : 'text-accent-700'">DAY</span>
                <span class="absolute right-4 text-sm font-semibold pointer-events-none select-none" :class="theme === 'dark' ? 'text-primary-300' : 'text-gray-500'">NIGHT</span>
                <!-- Knob -->
                <span class="absolute top-1 w-8 h-8 rounded-full flex items-center justify-center transition-all duration-300 z-10"
                      :class="theme === 'dark' ? 'right-1 bg-dark-900 text-primary-300 shadow-[0_0_0_2px_rgba(30,41,59,0.9),0_4px_10px_rgba(0,0,0,0.35)]' : 'left-1 bg-white text-accent-500 shadow-[0_0_0_2px_rgba(252,211,77,0),0_4px_10px_rgba(0,0,0,0.15)]'">
                  <svg v-if="theme === 'dark'" class="w-4 h-4" viewBox="0 0 24 24" fill="currentColor"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/></svg>
                  <svg v-else class="w-4 h-4" viewBox="0 0 24 24" fill="currentColor"><path d="M12 18a6 6 0 1 0 0-12 6 6 0 0 0 0 12z"/></svg>
                </span>
              </button>
            </div>
          </div>
          <button 
            @click="toggleMobileMenu"
            class="md:hidden text-gray-700 hover:text-accent-600 transition-colors duration-300 dark:text-gray-300 dark:hover:text-primary-400"
          >
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
            </svg>
          </button>
        </div>
        
        <!-- Mobile Menu -->
        <div v-if="mobileMenuOpen" class="md:hidden mt-4 pb-4 border-t pt-4 border-accent-200 dark:border-dark-800">
          <div class="flex flex-col space-y-4">
            <div class="flex items-center space-x-3">
              <span class="text-gray-600 text-sm dark:text-gray-400">{{ t('nav.language') }}:</span>
              <button @click="setLocale('uk')"
                      :class="['px-3 py-1 rounded-md text-sm border transition-colors', locale === 'uk' ? 'bg-accent-500/20 text-accent-700 border-accent-500 dark:bg-primary-600/30 dark:text-primary-200 dark:border-primary-600' : 'bg-white text-gray-700 border-accent-300 hover:border-accent-500 dark:bg-dark-800 dark:text-gray-300 dark:border-dark-700 dark:hover:border-primary-600/60']">
                UA
              </button>
              <button @click="setLocale('en')"
                      :class="['px-3 py-1 rounded-md text-sm border transition-colors', locale === 'en' ? 'bg-accent-500/20 text-accent-700 border-accent-500 dark:bg-primary-600/30 dark:text-primary-200 dark:border-primary-600' : 'bg-white text-gray-700 border-accent-300 hover:border-accent-500 dark:bg-dark-800 dark:text-gray-300 dark:border-dark-700 dark:hover:border-primary-600/60']">
                EN
              </button>
              <!-- Theme toggle in mobile (compact pill) -->
              <button @click="toggleTheme" :aria-pressed="theme === 'dark'" class="ml-2 relative inline-flex items-center rounded-full transition-colors duration-300 select-none w-24 h-9 border bg-accent-100/80 border-accent-200 text-accent-700 dark:bg-dark-800 dark:border-dark-700 dark:text-gray-200">
                <span class="absolute left-3 text-xs font-semibold pointer-events-none select-none" :class="theme === 'dark' ? 'text-gray-400' : 'text-accent-700'">DAY</span>
                <span class="absolute right-3 text-xs font-semibold pointer-events-none select-none" :class="theme === 'dark' ? 'text-primary-300' : 'text-gray-500'">NIGHT</span>
                <span class="absolute top-1 w-7 h-7 rounded-full flex items-center justify-center transition-all duration-300 z-10"
                      :class="theme === 'dark' ? 'right-1 bg-dark-900 text-primary-300 shadow-[0_0_0_2px_rgba(30,41,59,0.9),0_4px_10px_rgba(0,0,0,0.35)]' : 'left-1 bg-white text-accent-500 shadow-[0_0_0_2px_rgba(252,211,77,0),0_4px_10px_rgba(0,0,0,0.15)]'">
                  <svg v-if="theme === 'dark'" class="w-3.5 h-3.5" viewBox="0 0 24 24" fill="currentColor"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/></svg>
                  <svg v-else class="w-3.5 h-3.5" viewBox="0 0 24 24" fill="currentColor"><path d="M12 18a6 6 0 1 0 0-12 6 6 0 0 0 0 12z"/></svg>
                </span>
              </button>
            </div>
            <a href="#home" @click="closeMobileMenu" class="text-gray-700 hover:text-accent-600 transition-colors duration-300 dark:text-gray-300 dark:hover:text-primary-400">{{ t('nav.home') }}</a>
            <a href="#skills" @click="closeMobileMenu" class="text-gray-700 hover:text-accent-600 transition-colors duration-300 dark:text-gray-300 dark:hover:text-primary-400">{{ t('nav.skills') }}</a>
            <a href="#projects" @click="closeMobileMenu" class="text-gray-700 hover:text-accent-600 transition-colors duration-300 dark:text-gray-300 dark:hover:text-primary-400">{{ t('nav.projects') }}</a>
            <a href="#contact" @click="closeMobileMenu" class="text-gray-700 hover:text-accent-600 transition-colors duration-300 dark:text-gray-300 dark:hover:text-primary-400">{{ t('nav.contact') }}</a>
          </div>
        </div>
      </div>
    </nav>

    <!-- Main Content -->
    <main class="relative z-20">
      <Header />
      <Skills />
      <Projects />
      <Contacts />
    </main>

    <!-- Footer -->
    <footer class="py-8 relative z-10 bg-accent-100 border-t border-accent-200 dark:bg-dark-800 dark:border-dark-700">
      <div class="container-max px-6 text-center">
        <p class="text-gray-600 dark:text-gray-400">Â© 2024 Dmytro. All rights reserved.</p>
      </div>
    </footer>
  </div>
</template>

<script setup lang="ts">
import { ref, onMounted, onUnmounted, provide } from 'vue'
import Header from './components/Header.vue'
import Skills from './components/Skills.vue'
import Projects from './components/Projects.vue'
import ParticleBackground from './components/ParticleBackground.vue'
import Contacts from './components/Contacts.vue'

const mobileMenuOpen = ref(false)

// i18n minimal setup
type Locale = 'en' | 'uk'
const stored = (typeof window !== 'undefined' && window.localStorage.getItem('locale')) as Locale | null
const locale = ref<Locale>(stored ?? 'uk')

const messages = {
  en: {
    // nav
    'nav.home': 'Home',
    'nav.skills': 'Skills',
    'nav.projects': 'Projects',
    'nav.contact': 'Contact',
    'nav.language': 'Language',
    // hero/about (in Header.vue)
    'hero.title': 'Full Stack Web Middle Developer',
    'hero.subtitle': 'Passionate about creating innovative web solutions, Telegram bots, and automating processes to make life easier.',
    'about.title': 'About Me',
    'about.subheading': 'Full Stack Developer with a Passion for Innovation',
    'about.paragraph': 'I specialize in developing modern web applications that combine beautiful user interfaces with robust backend systems. My expertise spans across the entire development stack, from frontend frameworks to database design.',
    'about.cards.web.title': 'Web Applications',
    'about.cards.web.desc': 'Creating responsive, user-friendly web applications using modern frameworks like Vue.js, React, and Node.js.',
    'about.cards.telegram.title': 'Telegram Bots',
    'about.cards.telegram.desc': 'Developing intelligent Telegram bots that automate tasks, provide customer support, and enhance user engagement.',
    'about.cards.automation.title': 'Process Automation',
    'about.cards.automation.desc': 'Streamlining workflows and automating repetitive tasks using n8n and custom solutions to improve efficiency.',
    // skills
    'skills.title': 'Skills & Technologies',
    'skills.alwaysLearning.title': 'Always Learning',
    'skills.alwaysLearning.p1': "Technology evolves rapidly, and I'm committed to staying current with the latest trends and best practices.",
    'skills.alwaysLearning.p2': 'I regularly explore new frameworks, tools, and methodologies to deliver cutting-edge solutions.',
    'skills.interests.ai': 'AI/ML Integration',
    'skills.interests.microservices': 'Microservices',
    'skills.interests.graphql': 'GraphQL',
    'skills.interests.rust': 'Rust',
    'skills.interests.k8s': 'Kubernetes',
    'skills.interests.web3': 'Web3',
    'skills.interests.serverless': 'Serverless',
    'skills.interests.pwa': 'PWA',
    // projects
    'projects.title': 'Featured Projects',
    'projects.cta.title': 'Interested in Working Together?',
    'projects.cta.p1': "I'm always excited to take on new challenges and create innovative solutions.",
    'projects.cta.p2': "Let's discuss how we can bring your ideas to life.",
    'projects.cta.button': 'Start a Project',
    'projects.items.1.title': 'E-Commerce Platform',
    'projects.items.1.desc': 'Full-stack e-commerce solution with Vue.js frontend, Node.js backend, and PostgreSQL database. Features include user authentication, payment processing, and admin dashboard.',
    'projects.items.2.title': 'Telegram Bot Assistant',
    'projects.items.2.desc': 'Intelligent Telegram bot that helps users manage tasks, set reminders, and get weather updates. Built with Python and integrated with various APIs.',
    'projects.items.3.title': 'Workflow Automation',
    'projects.items.3.desc': 'Custom n8n workflows that automate business processes, including data synchronization between different platforms and automated reporting.',
    'projects.items.4.title': 'Real-time Chat App',
    'projects.items.4.desc': 'Modern chat application with real-time messaging, file sharing, and group conversations. Built with Vue.js and Socket.io.',
    'projects.items.5.title': 'Analytics Dashboard',
    'projects.items.5.desc': 'Interactive dashboard for data visualization and analytics with real-time charts, filters, and export functionality.',
    'projects.items.6.title': 'Task Management System',
    'projects.items.6.desc': 'Comprehensive project management tool with kanban boards, time tracking, and team collaboration features.',
    // contacts
    'contact.title': 'Get In Touch',
    'contact.intro.p1': "Ready to start your next project? I'm always interested in discussing new opportunities",
    'contact.intro.p2': 'and innovative ideas. Let\'s connect and create something amazing together.',
    'contact.card.title': "Let's Connect",
    'contact.telegram': 'Telegram',
    'contact.github': 'GitHub',
    'contact.email': 'Email',
    'contact.stats.years': 'Years Experience',
    'contact.stats.projects': 'Projects Completed',
  },
  uk: {
    // nav
    'nav.home': 'ÐÐ¾Ð»Ð¾Ð²Ð½Ð°',
    'nav.skills': 'ÐÐ°Ð²Ð¸ÑÐºÐ¸',
    'nav.projects': 'ÐÑÐ¾ÑÐºÑÐ¸',
    'nav.contact': 'ÐÐ¾Ð½ÑÐ°ÐºÑÐ¸',
    'nav.language': 'ÐÐ¾Ð²Ð°',
    // hero/about (in Header.vue)
    'hero.title': 'Middle Full Stack ÐÐµÐ± Ð Ð¾Ð·ÑÐ¾Ð±Ð½Ð¸Ðº',
    'hero.subtitle': 'ÐÐ°ÑÐ¾Ð¿Ð»ÑÑÑÑ ÑÑÐ²Ð¾ÑÐµÐ½Ð½ÑÐ¼ ÑÐ½Ð½Ð¾Ð²Ð°ÑÑÐ¹Ð½Ð¸Ñ Ð²ÐµÐ±âÑÑÑÐµÐ½Ñ, TelegramâÐ±Ð¾ÑÑÐ² ÑÐ° Ð°Ð²ÑÐ¾Ð¼Ð°ÑÐ¸Ð·Ð°ÑÑÑÑ Ð¿ÑÐ¾ÑÐµÑÑÐ², ÑÐ¾Ð± ÑÐ¾Ð±Ð¸ÑÐ¸ Ð¶Ð¸ÑÑÑ Ð¿ÑÐ¾ÑÑÑÑÐ¸Ð¼.',
    'about.title': 'ÐÑÐ¾ Ð¼ÐµÐ½Ðµ',
    'about.subheading': 'Full Stack ÑÐ¾Ð·ÑÐ¾Ð±Ð½Ð¸Ðº ÑÐ· Ð¿ÑÐ¸ÑÑÑÐ°ÑÑÑ Ð´Ð¾ ÑÐ½Ð½Ð¾Ð²Ð°ÑÑÐ¹',
    'about.paragraph': 'Ð¯ ÑÐ¿ÐµÑÑÐ°Ð»ÑÐ·ÑÑÑÑ Ð½Ð° ÑÐ¾Ð·ÑÐ¾Ð±ÑÑ ÑÑÑÐ°ÑÐ½Ð¸Ñ Ð²ÐµÐ±âÐ´Ð¾Ð´Ð°ÑÐºÑÐ², ÑÐ¾ Ð¿Ð¾ÑÐ´Ð½ÑÑÑÑ ÐºÑÐ°ÑÐ¸Ð²Ð¸Ð¹ ÑÐ½ÑÐµÑÑÐµÐ¹Ñ ÑÐ· Ð½Ð°Ð´ÑÐ¹Ð½Ð¸Ð¼ Ð±ÐµÐºÐµÐ½Ð´Ð¾Ð¼. ÐÑÐ¹ Ð´Ð¾ÑÐ²ÑÐ´ Ð¾ÑÐ¾Ð¿Ð»ÑÑ Ð²ÐµÑÑ ÑÑÐµÐº â Ð²ÑÐ´ ÑÑÐ¾Ð½ÑÐµÐ½Ð´Ñ Ð´Ð¾ Ð¿ÑÐ¾ÑÐºÑÑÐ²Ð°Ð½Ð½Ñ Ð±Ð°Ð· Ð´Ð°Ð½Ð¸Ñ.',
    'about.cards.web.title': 'ÐÐµÐ±âÐ´Ð¾Ð´Ð°ÑÐºÐ¸',
    'about.cards.web.desc': 'Ð¡ÑÐ²Ð¾ÑÐµÐ½Ð½Ñ Ð°Ð´Ð°Ð¿ÑÐ¸Ð²Ð½Ð¸Ñ, Ð·ÑÑÑÐ½Ð¸Ñ Ð²ÐµÐ±âÐ´Ð¾Ð´Ð°ÑÐºÑÐ² ÑÐ· ÑÑÑÐ°ÑÐ½Ð¸Ð¼Ð¸ ÑÑÐµÐ¹Ð¼Ð²Ð¾ÑÐºÐ°Ð¼Ð¸, ÑÐºâÐ¾Ñ Vue.js, React ÑÐ° Node.js.',
    'about.cards.telegram.title': 'TelegramâÐ±Ð¾ÑÐ¸',
    'about.cards.telegram.desc': 'Ð Ð¾Ð·ÑÐ¾Ð±ÐºÐ° ÑÐ¾Ð·ÑÐ¼Ð½Ð¸Ñ TelegramâÐ±Ð¾ÑÑÐ² Ð´Ð»Ñ Ð°Ð²ÑÐ¾Ð¼Ð°ÑÐ¸Ð·Ð°ÑÑÑ Ð·Ð°Ð´Ð°Ñ, Ð¿ÑÐ´ÑÑÐ¸Ð¼ÐºÐ¸ ÐºÐ¾ÑÐ¸ÑÑÑÐ²Ð°ÑÑÐ² ÑÐ° Ð¿ÑÐ´Ð²Ð¸ÑÐµÐ½Ð½Ñ Ð·Ð°Ð»ÑÑÐµÐ½Ð¾ÑÑÑ.',
    'about.cards.automation.title': 'ÐÐ²ÑÐ¾Ð¼Ð°ÑÐ¸Ð·Ð°ÑÑÑ Ð¿ÑÐ¾ÑÐµÑÑÐ²',
    'about.cards.automation.desc': 'ÐÐ¿ÑÐ¸Ð¼ÑÐ·Ð°ÑÑÑ ÑÐ¾Ð±Ð¾ÑÐ¸Ñ Ð¿ÑÐ¾ÑÐµÑÑÐ² Ñ Ð°Ð²ÑÐ¾Ð¼Ð°ÑÐ¸Ð·Ð°ÑÑÑ ÑÑÑÐ¸Ð½Ð½Ð¸Ñ Ð·Ð°Ð´Ð°Ñ Ð·Ð° Ð´Ð¾Ð¿Ð¾Ð¼Ð¾Ð³Ð¾Ñ n8n Ñ ÐºÐ°ÑÑÐ¾Ð¼Ð½Ð¸Ñ ÑÑÑÐµÐ½Ñ.',
    // skills
    'skills.title': 'ÐÐ°Ð²Ð¸ÑÐºÐ¸ ÑÐ° ÑÐµÑÐ½Ð¾Ð»Ð¾Ð³ÑÑ',
    'skills.alwaysLearning.title': 'ÐÐ¾ÑÑÑÐ¹Ð½Ð¾ Ð½Ð°Ð²ÑÐ°ÑÑÑ',
    'skills.alwaysLearning.p1': 'Ð¢ÐµÑÐ½Ð¾Ð»Ð¾Ð³ÑÑ ÑÐ²Ð¸Ð´ÐºÐ¾ ÑÐ¾Ð·Ð²Ð¸Ð²Ð°ÑÑÑÑÑ, Ñ Ñ Ð¿Ð¾ÑÑÑÐ¹Ð½Ð¾ ÑÑÐµÐ¶Ñ Ð·Ð° ÑÑÐµÐ½Ð´Ð°Ð¼Ð¸ ÑÐ° Ð½Ð°Ð¹ÐºÑÐ°ÑÐ¸Ð¼Ð¸ Ð¿ÑÐ°ÐºÑÐ¸ÐºÐ°Ð¼Ð¸.',
    'skills.alwaysLearning.p2': 'Ð ÐµÐ³ÑÐ»ÑÑÐ½Ð¾ Ð´Ð¾ÑÐ»ÑÐ´Ð¶ÑÑ Ð½Ð¾Ð²Ñ ÑÑÐµÐ¹Ð¼Ð²Ð¾ÑÐºÐ¸, ÑÐ½ÑÑÑÑÐ¼ÐµÐ½ÑÐ¸ Ð¹ Ð¼ÐµÑÐ¾Ð´Ð¾Ð»Ð¾Ð³ÑÑ, ÑÐ¾Ð± ÑÑÐ²Ð¾ÑÑÐ²Ð°ÑÐ¸ ÑÑÑÐ°ÑÐ½Ñ ÑÑÑÐµÐ½Ð½Ñ.',
    'skills.interests.ai': 'ÐÐ½ÑÐµÐ³ÑÐ°ÑÑÑ AI/ML',
    'skills.interests.microservices': 'ÐÑÐºÑÐ¾ÑÐµÑÐ²ÑÑÐ¸',
    'skills.interests.graphql': 'GraphQL',
    'skills.interests.rust': 'Rust',
    'skills.interests.k8s': 'Kubernetes',
    'skills.interests.web3': 'Web3',
    'skills.interests.serverless': 'Serverless',
    'skills.interests.pwa': 'PWA',
    // projects
    'projects.title': 'ÐÐ±ÑÐ°Ð½Ñ Ð¿ÑÐ¾ÑÐºÑÐ¸',
    'projects.cta.title': 'Ð¦ÑÐºÐ°Ð²Ð¸ÑÑ ÑÐ¿ÑÐ²Ð¿ÑÐ°ÑÑ?',
    'projects.cta.p1': 'Ð¯ Ð·Ð°Ð²Ð¶Ð´Ð¸ ÑÐ°Ð´Ð¸Ð¹ Ð½Ð¾Ð²Ð¸Ð¼ Ð²Ð¸ÐºÐ»Ð¸ÐºÐ°Ð¼ Ñ ÑÑÐ²Ð¾ÑÐµÐ½Ð½Ñ ÑÐ½Ð½Ð¾Ð²Ð°ÑÑÐ¹Ð½Ð¸Ñ ÑÑÑÐµÐ½Ñ.',
    'projects.cta.p2': 'ÐÐ°Ð²Ð°Ð¹ÑÐµ Ð¾Ð±Ð³Ð¾Ð²Ð¾ÑÐ¸Ð¼Ð¾, ÑÐº Ð²ÑÑÐ»Ð¸ÑÐ¸ Ð²Ð°ÑÑ ÑÐ´ÐµÑ Ñ Ð¶Ð¸ÑÑÑ.',
    'projects.cta.button': 'ÐÐ¾ÑÐ°ÑÐ¸ Ð¿ÑÐ¾ÑÐºÑ',
    'projects.items.1.title': 'ÐÐ»Ð°ÑÑÐ¾ÑÐ¼Ð° eâcommerce',
    'projects.items.1.desc': 'ÐÐ¾Ð²Ð½Ð¾ÑÑÐ½Ð½Ðµ eâcommerce ÑÑÑÐµÐ½Ð½Ñ: ÑÑÐ¾Ð½ÑÐµÐ½Ð´ Ð½Ð° Vue.js, Ð±ÐµÐºÐµÐ½Ð´ Ð½Ð° Node.js, ÐÐ PostgreSQL. Ð¤ÑÑÑ: Ð°Ð²ÑÐµÐ½ÑÐ¸ÑÑÐºÐ°ÑÑÑ, Ð¾Ð¿Ð»Ð°ÑÐ¸, Ð°Ð´Ð¼ÑÐ½âÐ¿Ð°Ð½ÐµÐ»Ñ.',
    'projects.items.2.title': 'TelegramâÐ±Ð¾Ñ Ð¿Ð¾Ð¼ÑÑÐ½Ð¸Ðº',
    'projects.items.2.desc': 'Ð Ð¾Ð·ÑÐ¼Ð½Ð¸Ð¹ TelegramâÐ±Ð¾Ñ Ð´Ð»Ñ Ð·Ð°Ð´Ð°Ñ, Ð½Ð°Ð³Ð°Ð´ÑÐ²Ð°Ð½Ñ Ñ Ð¿Ð¾Ð³Ð¾Ð´Ð¸. ÐÐ¾Ð±ÑÐ´Ð¾Ð²Ð°Ð½Ð¸Ð¹ Ð½Ð° Python ÑÐ° ÑÐ½ÑÐµÐ³ÑÐ¾Ð²Ð°Ð½Ð¸Ð¹ Ð· ÑÑÐ·Ð½Ð¸Ð¼Ð¸ API.',
    'projects.items.3.title': 'ÐÐ²ÑÐ¾Ð¼Ð°ÑÐ¸Ð·Ð°ÑÑÑ ÑÐ¾Ð±Ð¾ÑÐ¸Ñ Ð¿ÑÐ¾ÑÐµÑÑÐ²',
    'projects.items.3.desc': 'ÐÐ°ÑÑÐ¾Ð¼Ð½Ñ ÑÑÐµÐ½Ð°ÑÑÑ n8n Ð´Ð»Ñ Ð°Ð²ÑÐ¾Ð¼Ð°ÑÐ¸Ð·Ð°ÑÑÑ Ð±ÑÐ·Ð½ÐµÑâÐ¿ÑÐ¾ÑÐµÑÑÐ²: ÑÐ¸Ð½ÑÑÐ¾Ð½ÑÐ·Ð°ÑÑÑ Ð´Ð°Ð½Ð¸Ñ Ñ Ð°Ð²ÑÐ¾Ð¼Ð°ÑÐ¸ÑÐ½Ð° Ð·Ð²ÑÑÐ½ÑÑÑÑ.',
    'projects.items.4.title': 'Ð§Ð°Ñ Ñ ÑÐµÐ°Ð»ÑÐ½Ð¾Ð¼Ñ ÑÐ°ÑÑ',
    'projects.items.4.desc': 'Ð¡ÑÑÐ°ÑÐ½Ð¸Ð¹ ÑÐ°Ñ ÑÐ· Ð¼Ð¸ÑÑÑÐ²Ð¸Ð¼Ð¸ Ð¿Ð¾Ð²ÑÐ´Ð¾Ð¼Ð»ÐµÐ½Ð½ÑÐ¼Ð¸, ÑÐ°Ð¹Ð»Ð°Ð¼Ð¸ ÑÐ° Ð³ÑÑÐ¿Ð°Ð¼Ð¸. ÐÐ¾Ð±ÑÐ´Ð¾Ð²Ð°Ð½Ð¸Ð¹ Ð½Ð° Vue.js Ñ Socket.io.',
    'projects.items.5.title': 'ÐÐ½Ð°Ð»ÑÑÐ¸ÑÐ½Ð° Ð¿Ð°Ð½ÐµÐ»Ñ',
    'projects.items.5.desc': 'ÐÐ½ÑÐµÑÐ°ÐºÑÐ¸Ð²Ð½Ð° Ð¿Ð°Ð½ÐµÐ»Ñ Ð´Ð»Ñ Ð²ÑÐ·ÑÐ°Ð»ÑÐ·Ð°ÑÑÑ Ð´Ð°Ð½Ð¸Ñ: Ð³ÑÐ°ÑÑÐºÐ¸ Ð² ÑÐµÐ°Ð»ÑÐ½Ð¾Ð¼Ñ ÑÐ°ÑÑ, ÑÑÐ»ÑÑÑÐ¸, ÐµÐºÑÐ¿Ð¾ÑÑ.',
    'projects.items.6.title': 'Ð¡Ð¸ÑÑÐµÐ¼Ð° ÐºÐµÑÑÐ²Ð°Ð½Ð½Ñ Ð·Ð°Ð´Ð°ÑÐ°Ð¼Ð¸',
    'projects.items.6.desc': 'ÐÐ½ÑÑÑÑÐ¼ÐµÐ½Ñ Ð´Ð»Ñ Ð¼ÐµÐ½ÐµÐ´Ð¶Ð¼ÐµÐ½ÑÑ Ð¿ÑÐ¾ÑÐºÑÑÐ²: ÐºÐ°Ð½Ð±Ð°Ð½, ÑÑÐµÐºÑÐ½Ð³ ÑÐ°ÑÑ, ÐºÐ¾Ð¼Ð°Ð½Ð´Ð½Ð° ÑÐ¿ÑÐ²Ð¿ÑÐ°ÑÑ.',
    // contacts
    'contact.title': 'ÐÐ²Ê¼ÑÐ¶ÑÑÑÑÑ Ð·Ñ Ð¼Ð½Ð¾Ñ',
    'contact.intro.p1': 'ÐÐ¾ÑÐ¾Ð²Ñ ÑÐ¾Ð·Ð¿Ð¾ÑÐ°ÑÐ¸ Ð½Ð°ÑÑÑÐ¿Ð½Ð¸Ð¹ Ð¿ÑÐ¾ÑÐºÑ? ÐÐµÐ½Ñ ÑÑÐºÐ°Ð²Ñ Ð½Ð¾Ð²Ñ Ð¼Ð¾Ð¶Ð»Ð¸Ð²Ð¾ÑÑÑ',
    'contact.intro.p2': 'ÑÐ° ÑÐ½Ð½Ð¾Ð²Ð°ÑÑÐ¹Ð½Ñ ÑÐ´ÐµÑ. ÐÐ°Ð²Ð°Ð¹ÑÐµ ÑÑÐ²Ð¾ÑÐ¸Ð¼Ð¾ ÑÐ¾ÑÑ ÐºÑÑÑÐµ ÑÐ°Ð·Ð¾Ð¼.',
    'contact.card.title': 'ÐÐ°Ð²Ð°Ð¹ÑÐµ Ð·Ð²\'ÑÐ¶ÐµÐ¼Ð¾ÑÑ',
    'contact.telegram': 'Telegram',
    'contact.github': 'GitHub',
    'contact.email': 'Email',
    'contact.stats.years': 'Ð Ð¾ÐºÑÐ² Ð´Ð¾ÑÐ²ÑÐ´Ñ',
    'contact.stats.projects': 'ÐÐ°Ð²ÐµÑÑÐµÐ½Ð¸Ñ Ð¿ÑÐ¾ÑÐºÑÑÐ²',
  }
} as const

const t = (key: keyof typeof messages['en']): string => {
  return (messages as any)[locale.value][key] ?? String(key)
}

const setLocale = (l: Locale) => {
  locale.value = l
  if (typeof window !== 'undefined') {
    window.localStorage.setItem('locale', l)
  }
}

// provide to children
provide('t', t)
provide('locale', locale)

// Theme toggle
type Theme = 'light' | 'dark'
const theme = ref<Theme>('dark')

const applyTheme = (value: Theme) => {
  const root = document.documentElement
  if (value === 'dark') root.classList.add('dark')
  else root.classList.remove('dark')
}

const loadTheme = (): Theme => {
  if (typeof window === 'undefined') return 'dark'
  const saved = window.localStorage.getItem('theme') as Theme | null
  return saved ?? 'dark'
}

const toggleTheme = () => {
  theme.value = theme.value === 'dark' ? 'light' : 'dark'
  if (typeof window !== 'undefined') window.localStorage.setItem('theme', theme.value)
  applyTheme(theme.value)
}

const toggleMobileMenu = () => {
  mobileMenuOpen.value = !mobileMenuOpen.value
}

const closeMobileMenu = () => {
  mobileMenuOpen.value = false
}

// Intersection Observer for animations
const observeElements = () => {
  const observer = new IntersectionObserver(
    (entries) => {
      entries.forEach((entry) => {
        if (entry.isIntersecting) {
          entry.target.classList.add('visible')
        }
      })
    },
    {
      threshold: 0.1,
      rootMargin: '0px 0px -50px 0px'
    }
  )

  const elements = document.querySelectorAll('.fade-in-up')
  elements.forEach((el) => observer.observe(el))
}

onMounted(() => {
  // init theme
  theme.value = loadTheme()
  applyTheme(theme.value)
  setTimeout(observeElements, 100)
})

// Close mobile menu when clicking outside
const handleClickOutside = (event: Event) => {
  const target = event.target as HTMLElement
  if (!target.closest('nav') && mobileMenuOpen.value) {
    mobileMenuOpen.value = false
  }
}

onMounted(() => {
  document.addEventListener('click', handleClickOutside)
})

onUnmounted(() => {
  document.removeEventListener('click', handleClickOutside)
})
</script>
